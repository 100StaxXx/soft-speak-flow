import{H as k,r as q,q as o,j as e,co as C,ac as b,Y as h,c5 as y,cG as T,dI as g}from"./vendor-DK8VKJIv.js";import{c as L,e as D,S as F,B as p,ae as P,af as Q,ag as f,ah as j,f as l,av as S,s as d}from"./index-vNUnYBjj.js";import{P as B}from"./PepTalkCard-Bf2ZIl8x.js";import{Q as E}from"./QuoteCard-Cm3HBnaL.js";import"./date-vendor-BRrA_NVo.js";import"./three-vendor-qI8GXUTd.js";import"./clipboard-3OJHfwXT.js";import"./redirectUrl-BrdfvnoF.js";function G(){const{user:r}=L(),c=k(),[N,v]=q.useState("favorites"),{data:a,isLoading:w}=o({queryKey:["favorites",r?.id],enabled:!!r,queryFn:async()=>{if(!r?.id)throw new Error("User not authenticated");const{data:s,error:t}=await d.from("favorites").select(`
          id,
          content_type,
          content_id,
          created_at
        `).eq("user_id",r.id).order("created_at",{ascending:!1});if(t)throw t;return s||[]},staleTime:300*1e3}),{data:m,isLoading:_}=o({queryKey:["downloads",r?.id],enabled:!!r,queryFn:async()=>{if(!r?.id)throw new Error("User not authenticated");const{data:s,error:t}=await d.from("downloads").select(`
          id,
          content_type,
          content_id,
          created_at
        `).eq("user_id",r.id).order("created_at",{ascending:!1});if(t)throw t;return s||[]},staleTime:300*1e3}),{data:x}=o({queryKey:["favorite-quotes",a],enabled:!!a&&a.filter(s=>s.content_type==="quote").length>0,queryFn:async()=>{const s=a?.filter(i=>i.content_type==="quote").map(i=>i.content_id)||[];if(s.length===0)return[];const{data:t,error:n}=await d.from("quotes").select("*").in("id",s);if(n)throw n;return t||[]},staleTime:300*1e3}),{data:u}=o({queryKey:["favorite-pep-talks",a],enabled:!!a&&a.filter(s=>s.content_type==="pep_talk").length>0,queryFn:async()=>{const s=a?.filter(i=>i.content_type==="pep_talk").map(i=>i.content_id)||[];if(s.length===0)return[];const{data:t,error:n}=await d.from("pep_talks").select("*").in("id",s);if(n)throw n;return t||[]},staleTime:300*1e3});return e.jsxs(D,{children:[e.jsx(F,{}),e.jsx("div",{className:"min-h-screen pb-nav-safe pt-safe relative z-10",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs(p,{variant:"ghost",onClick:()=>c("/profile"),className:"mb-4",children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Back"]}),e.jsx("h1",{className:"text-3xl sm:text-4xl font-semibold tracking-tight bg-gradient-to-r from-primary via-accent to-primary bg-clip-text text-transparent",children:"My Library"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Your saved content and history"})]}),e.jsxs(P,{value:N,onValueChange:s=>v(s),className:"w-full",children:[e.jsxs(Q,{className:"grid w-full grid-cols-3 mb-8 bg-card/80 border border-border/60",children:[e.jsxs(f,{value:"favorites",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Favorites"]}),e.jsxs(f,{value:"downloads",children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),"Downloads"]}),e.jsxs(f,{value:"history",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"History"]})]}),e.jsx(j,{value:"favorites",className:"space-y-6",children:w?e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"})}):a&&a.length>0?e.jsxs(e.Fragment,{children:[x&&x.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Quotes"})]}),e.jsx("div",{className:"grid gap-4",children:x.map(s=>e.jsx(E,{quote:{id:s.id,text:s.text,author:s.author||"Unknown",is_premium:s.is_premium||!1}},s.id))})]}),u&&u.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Pep Talks"})]}),e.jsx("div",{className:"grid gap-4",children:u.map(s=>e.jsx(B,{id:s.id,title:s.title,category:s.category,quote:s.quote,description:s.description,isPremium:s.is_premium||!1},s.id))})]})]}):e.jsxs(l,{className:"p-12 text-center bg-card/50 backdrop-blur-sm border-border/50",children:[e.jsx(b,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No favorites yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Start favoriting quotes and pep talks to build your collection"}),e.jsx(p,{onClick:()=>c("/inspire"),children:"Explore Content"})]})}),e.jsx(j,{value:"downloads",className:"space-y-6",children:_?e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"})}):m&&m.length>0?e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsx(l,{className:"p-4 bg-card/50 backdrop-blur-sm border-border/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:S(s.content_type)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})]}),e.jsx(h,{className:"h-5 w-5 text-primary"})]})},s.id))}):e.jsx(l,{className:"p-12 text-center bg-card/50 backdrop-blur-sm border-border/50",children:e.jsxs("div",{className:"max-w-md mx-auto space-y-4",children:[e.jsx("div",{className:"h-16 w-16 mx-auto rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(h,{className:"h-8 w-8 text-primary"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-bold",children:"No downloads yet"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Download pep talks and quotes for offline access. Your downloaded content will appear here."})]}),e.jsxs(p,{onClick:()=>c("/pep-talks"),className:"mt-4",children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"Browse Pep Talks"]})]})})}),e.jsx(j,{value:"history",className:"space-y-6",children:e.jsxs(l,{className:"p-12 text-center bg-card/50 backdrop-blur-sm border-border/50",children:[e.jsx(y,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Coming Soon"}),e.jsx("p",{className:"text-muted-foreground",children:"View your content history and recently played items"})]})})]})]})})]})}export{G as default};
