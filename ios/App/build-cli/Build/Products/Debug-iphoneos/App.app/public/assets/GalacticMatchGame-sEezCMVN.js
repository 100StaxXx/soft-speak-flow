import{r as i,j as e,m as l,af as xe,l as P}from"./vendor-FfY6MM0Z.js";import{t as O}from"./gameUtils-G90wW1BE.js";import{bv as he,bo as ae,bw as fe,bx as ve}from"./index-sX_cJ3I4.js";import"./date-vendor-Bk4KiHsJ.js";import"./three-vendor-qI8GXUTd.js";const ye={beginner:{startLives:5,revealTimeMultiplier:1.8,startPairs:2},easy:{startLives:4,revealTimeMultiplier:1.5,startPairs:2},medium:{startLives:3,revealTimeMultiplier:1.2,startPairs:2},hard:{startLives:2,revealTimeMultiplier:1,startPairs:3},master:{startLives:1,revealTimeMultiplier:.75,startPairs:4}},be={beginner:5,easy:4,medium:3,hard:2,master:1},U=[{emoji:"â­",name:"Star",color:"hsl(45, 93%, 58%)"},{emoji:"ðŸŒ™",name:"Moon",color:"hsl(210, 20%, 75%)"},{emoji:"â˜€ï¸",name:"Sun",color:"hsl(35, 100%, 55%)"},{emoji:"ðŸª",name:"Planet",color:"hsl(271, 60%, 55%)"},{emoji:"ðŸŒŠ",name:"Nebula",color:"hsl(190, 90%, 55%)"},{emoji:"ðŸ’«",name:"Comet",color:"hsl(330, 80%, 65%)"},{emoji:"ðŸ”®",name:"Crystal",color:"hsl(270, 70%, 60%)"},{emoji:"âš¡",name:"Energy",color:"hsl(50, 100%, 50%)"},{emoji:"ðŸŒŸ",name:"Supernova",color:"hsl(40, 100%, 65%)"},{emoji:"ðŸŒ€",name:"Vortex",color:"hsl(200, 80%, 55%)"},{emoji:"ðŸ”¥",name:"Flame",color:"hsl(15, 90%, 55%)"},{emoji:"â„ï¸",name:"Frost",color:"hsl(195, 80%, 70%)"},{emoji:"ðŸŒ¸",name:"Blossom",color:"hsl(330, 70%, 70%)"},{emoji:"ðŸ’Ž",name:"Diamond",color:"hsl(195, 100%, 75%)"},{emoji:"ðŸ€",name:"Clover",color:"hsl(120, 60%, 50%)"}],ge=150,Z=(w,n=1,f=2,z=1)=>{let g;f>=3?g=f+Math.floor((w-1)/2):w===1?g=f:g=3+Math.floor((w-2)/2),g=Math.min(g,15);const j=g*2;let v,p;j<=4?(v=2,p=2):j<=6?(v=3,p=2):j<=8?(v=4,p=2):j<=10?(v=5,p=2):j<=12?(v=4,p=3):j<=16?(v=4,p=4):j<=20?(v=5,p=4):j<=24?(v=6,p=4):(j<=30,v=6,p=5);const N=Math.min(3+(g-2)*.5,10)*z;return{pairs:g,cols:v,rows:p,revealTime:N,totalCards:j}},ie=i.memo(()=>e.jsxs("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-br from-purple-900 via-indigo-900 to-blue-900 border-2 border-purple-500/50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-30",children:[...Array(5)].map((w,n)=>e.jsx("div",{className:"absolute w-1 h-1 bg-white rounded-full animate-pulse",style:{left:`${20+n*15}%`,top:`${30+n%2*40}%`,animationDelay:`${n*.2}s`}},n))}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-400/30 to-cyan-400/30 flex items-center justify-center",children:e.jsx("span",{className:"text-xl opacity-50",children:"âœ¦"})})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent animate-pulse"})]}));ie.displayName="CardBack";const le=i.memo(({symbolIndex:w})=>{const n=U[w];return e.jsx("div",{className:"absolute inset-0 rounded-xl border-2 overflow-hidden flex items-center justify-center",style:{background:`radial-gradient(circle at center, ${n.color}20, hsl(var(--background)))`,borderColor:`${n.color}60`,boxShadow:`0 0 20px ${n.color}30, inset 0 0 20px ${n.color}10`},children:e.jsx("span",{className:"text-3xl sm:text-4xl filter drop-shadow-lg",children:n.emoji})})});le.displayName="CardFace";const re=i.memo(({color:w})=>e.jsx(l.div,{className:"absolute inset-0 pointer-events-none",initial:{opacity:1},animate:{opacity:0},exit:{opacity:0},transition:{duration:.5},children:[...Array(8)].map((n,f)=>e.jsx(l.div,{className:"absolute w-2 h-2 rounded-full",style:{backgroundColor:w,left:"50%",top:"50%"},initial:{scale:0,x:"-50%",y:"-50%"},animate:{scale:[0,1,0],x:`${Math.cos(f*Math.PI/4)*40-50}%`,y:`${Math.sin(f*Math.PI/4)*40-50}%`},transition:{duration:.5,ease:"easeOut"}},f))}));re.displayName="MatchEffect";const Se=({companionStats:w,onComplete:n,onDamage:f,tierAttackDamage:z=15,difficulty:g="medium",questIntervalScale:j=0,maxTimer:v,isPractice:p=!1,compact:_=!1})=>{const N=ye[g],oe=be[g],[t,ne]=i.useState(1),[k,ce]=i.useState(1),[R,de]=i.useState(N.startLives),[o,L]=i.useState("countdown"),[F,$]=i.useState([]),[J,E]=i.useState([]),[G,q]=i.useState(0),[C,B]=i.useState(0),[S,K]=i.useState(0),[D,V]=i.useState(!1),[Q,ee]=i.useState([]),[A,me]=i.useState(3),[Y,X]=i.useState(0),[te,se]=i.useState(0),d=i.useMemo(()=>Z(t,k,N.startPairs,N.revealTimeMultiplier),[t,k,N]),W=i.useCallback((s=!1)=>{const a=Array.from({length:d.pairs},(r,c)=>c%U.length),m=[...a,...a];for(let r=m.length-1;r>0;r--){const c=Math.floor(Math.random()*(r+1));[m[r],m[c]]=[m[c],m[r]]}$(m.map((r,c)=>({id:`card-${t}-${c}`,symbolIndex:r,isFlipped:s,isMatched:!1}))),E([]),q(0),B(0)},[d.pairs,t]);i.useEffect(()=>{t===1&&W()},[]),i.useEffect(()=>{if(o==="countdown")if(A>0){const s=setTimeout(()=>me(A-1),1e3);return()=>clearTimeout(s)}else W(!0),L("revealing"),X(Math.ceil(d.revealTime))},[A,o,d.revealTime,W]),i.useEffect(()=>{if(o==="revealing")if(Y>0){const s=setTimeout(()=>X(Y-1),1e3);return()=>clearTimeout(s)}else L("hiding"),setTimeout(()=>{$(s=>s.map(a=>({...a,isFlipped:a.isMatched}))),setTimeout(()=>L("playing"),400)},200)},[Y,o]),i.useEffect(()=>{if(o==="playing"&&G===d.pairs){he(),O("success"),L("levelComplete");const s=te===0,a=s?ae.galactic_match.perfectLevel:ae.galactic_match.levelComplete;f?.({target:"adversary",amount:a,source:s?"perfect_level":"level_complete"});const m=15*t,r=S+m;K(r),setTimeout(()=>{if(p&&t>=2){n({success:!0,accuracy:100,result:"good",highScoreValue:t,gameStats:{level:t,score:r,maxCombo:C}});return}const H=d.pairs>=3&&k===1;let T,x,y;H?(T=t+1,x=2,y=Z(T,x,N.startPairs,N.revealTimeMultiplier)):(T=t+1,x=1,y=Z(T,x,N.startPairs,N.revealTimeMultiplier));const M=Array.from({length:y.pairs},(h,u)=>u%U.length),b=[...M,...M];for(let h=b.length-1;h>0;h--){const u=Math.floor(Math.random()*(h+1));[b[h],b[u]]=[b[u],b[h]]}$(b.map((h,u)=>({id:`card-${T}-${u}`,symbolIndex:h,isFlipped:!0,isMatched:!1}))),E([]),q(0),se(0),B(0),ne(T),ce(x),L("revealing"),X(Math.ceil(y.revealTime))},1500)}},[G,d.pairs,o,t,k,p,n,te,f,N,S,C]),i.useEffect(()=>{if(o!=="gameOver")return;const a=Math.min(100,Math.round(S/500*100)),m=t>=3?t>=6?"perfect":"good":"fail";m!=="fail"&&(fe(),O("success")),setTimeout(()=>{n({success:m!=="fail",accuracy:Math.min(a,100),result:m,highScoreValue:t,gameStats:{level:t,score:S,maxCombo:C}})},1500)},[o,S,t,n,C]);const ue=i.useCallback(s=>{if(D||o!=="playing")return;const a=F.find(r=>r.id===s);if(!a||a.isFlipped||a.isMatched)return;O("light"),$(r=>r.map(c=>c.id===s?{...c,isFlipped:!0}:c));const m=[...J,s];if(E(m),m.length===2){V(!0);const[r,c]=m,H=F.find(x=>x.id===r),T=F.find(x=>x.id===c);if(H.symbolIndex===T.symbolIndex){const x=C+1,y=Math.min(3,1+x*.5),M=10+t*2,b=Math.round(M*y);ve(),O("success"),B(x),K(u=>u+b),q(u=>u+1);const h=U[H.symbolIndex].color;ee(u=>[...u,{id:r,color:h},{id:c,color:h}]),setTimeout(()=>{$(u=>u.map(I=>I.id===r||I.id===c?{...I,isMatched:!0}:I)),ee(u=>u.filter(I=>I.id!==r&&I.id!==c)),E([]),V(!1)},400)}else{const x=R-1;de(x),B(0),se(y=>y+1),O("error"),f?.({target:"player",amount:z,source:"wrong_match"}),x<=0?setTimeout(()=>{$(y=>y.map(M=>M.id===r||M.id===c?{...M,isFlipped:!1}:M)),E([]),V(!1),L("gameOver")},800):setTimeout(()=>{$(b=>b.map(h=>({...h,isFlipped:h.isMatched||!0}))),E([]);const y=F.filter(b=>!b.isMatched).length,M=Math.min(1.5+y/4*.5,3);X(Math.ceil(M)),L("revealing"),V(!1)},800)}}},[F,J,D,o,C,R,t,f,z]),pe=i.useMemo(()=>({gridTemplateColumns:`repeat(${d.cols}, 1fr)`,gridTemplateRows:`repeat(${d.rows}, 1fr)`}),[d.cols,d.rows]);return e.jsxs("div",{className:`flex flex-col items-center flex-1 min-h-0 ${_?"gap-1 p-1":"gap-2 p-3"} select-none touch-none`,children:[e.jsxs("div",{className:"w-full flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[!_&&e.jsx("span",{className:"text-muted-foreground text-[10px]",children:"Level"}),e.jsx(l.span,{initial:{scale:1.5,color:"hsl(var(--primary))"},animate:{scale:1,color:"hsl(var(--foreground))"},className:`font-bold ${_?"text-sm":"text-base"}`,children:_?`Lv${t}`:t},`${t}-${k}`),d.pairs>=3&&e.jsxs("span",{className:"text-muted-foreground text-[10px] ml-0.5",children:["(",k,"/2)"]})]}),e.jsx("div",{className:"flex items-center gap-0.5",children:[...Array(oe)].map((s,a)=>e.jsx(l.div,{initial:!1,animate:{scale:a<R?1:.8,opacity:a<R?1:.3},transition:{type:"spring",stiffness:300},children:e.jsx(xe,{className:`w-4 h-4 ${a<R?"fill-red-500 text-red-500":"text-muted-foreground"}`})},a))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Score:"}),e.jsx(l.span,{initial:{scale:1.3,color:"hsl(var(--primary))"},animate:{scale:1,color:"hsl(var(--foreground))"},className:"font-bold",children:S},S)]})]}),e.jsx(P,{children:C>1&&o==="playing"&&e.jsxs(l.div,{initial:{scale:0,y:-10},animate:{scale:1,y:0},exit:{scale:0,opacity:0},className:"px-2 py-0.5 bg-yellow-500/20 rounded-full text-yellow-400 text-xs font-bold",children:["ðŸ”¥ ",C,"x COMBO!"]})}),e.jsxs("div",{className:"w-full flex items-center gap-1.5",children:[e.jsx("div",{className:"flex-1 h-1.5 bg-muted rounded-full overflow-hidden",children:e.jsx(l.div,{className:"h-full bg-gradient-to-r from-cyan-500 to-purple-500",initial:{width:0},animate:{width:`${G/d.pairs*100}%`},transition:{duration:.3}})}),e.jsxs("span",{className:"text-[10px] text-muted-foreground",children:[G,"/",d.pairs]})]}),e.jsxs("div",{className:"relative w-full max-w-sm mx-auto",style:{aspectRatio:`${d.cols}/${d.rows}`},children:[e.jsx(P,{children:o==="countdown"&&A>0&&e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-20 flex items-center justify-center bg-background/80 backdrop-blur-sm rounded-xl",children:e.jsx(l.span,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:2,opacity:0},className:"text-6xl font-bold text-primary",children:A},A)})}),e.jsx(P,{children:o==="revealing"&&e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-x-0 -top-12 z-20 flex flex-col items-center",children:e.jsxs(l.div,{className:"px-4 py-2 bg-cyan-500/90 rounded-full text-white font-bold shadow-lg",animate:{scale:[1,1.05,1]},transition:{duration:.5,repeat:1/0},children:["MEMORIZE! ",Y,"s"]})})}),e.jsx(P,{children:o==="hiding"&&e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-20 flex items-center justify-center",children:e.jsx(l.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:1.5,opacity:0},className:"text-4xl font-bold text-primary",children:"GO!"})})}),e.jsx(P,{children:o==="levelComplete"&&e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-20 flex items-center justify-center bg-background/80 backdrop-blur-sm rounded-xl",children:e.jsxs(l.div,{initial:{scale:0},animate:{scale:1},className:"text-center",children:[e.jsx(l.div,{className:"text-5xl mb-2",animate:{rotate:[0,-10,10,0]},transition:{duration:.5},children:"ðŸŽ‰"}),e.jsxs("div",{className:"text-2xl font-bold text-primary",children:["Level ",t," Complete!"]}),e.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:["+",15*t," bonus points"]})]})})}),e.jsx(P,{children:o==="gameOver"&&e.jsxs(l.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 z-20 flex items-center justify-center rounded-xl overflow-hidden",style:{background:"radial-gradient(ellipse at center, rgba(30, 20, 50, 0.95) 0%, rgba(15, 10, 30, 0.98) 100%)"},children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:Array.from({length:8}).map((s,a)=>e.jsx(l.div,{className:"absolute w-1.5 h-1.5 rounded-full",style:{left:`${10+a*12}%`,top:"-5%",background:"radial-gradient(circle, rgba(168, 85, 247, 0.8), rgba(100, 50, 150, 0.4))",boxShadow:"0 0 4px rgba(168, 85, 247, 0.5)"},animate:{y:["0%","120%"],opacity:[0,.7,0]},transition:{duration:3+a*.3,delay:a*.4,repeat:1/0,ease:"linear"}},a))}),e.jsxs(l.div,{initial:{scale:0},animate:{scale:1},className:"text-center px-4 relative z-10",children:[e.jsxs(l.div,{className:"relative inline-block mb-3",animate:{scale:[1,1.05,1]},transition:{duration:2,repeat:1/0},children:[e.jsx("div",{className:"absolute inset-0 blur-xl bg-purple-500/30 rounded-full"}),e.jsx("div",{className:"text-4xl relative z-10",children:t>=3?"ðŸŒŸ":"ðŸ’«"})]}),e.jsx(l.h3,{className:"text-xl font-black bg-gradient-to-r from-slate-300 via-purple-300 to-slate-400 bg-clip-text text-transparent mb-1",initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},children:t>=5?"Amazing Run!":t>=3?"Good Effort!":"The Void Prevails"}),e.jsx(l.p,{className:"text-sm text-purple-300/70 mb-3 italic",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:t>=3?"Your memory grows stronger each time":"Every attempt brings you closer to mastery"}),e.jsxs(l.div,{className:"space-y-1",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[e.jsxs("div",{className:"text-lg font-bold text-purple-400",children:["Reached Level ",t]}),e.jsxs("div",{className:"text-sm text-slate-400",children:["Final Score: ",Math.min(S,ge)," XP"]})]})]})]})}),e.jsx("div",{className:"grid gap-1 sm:gap-1.5 w-full h-full",style:pe,children:F.map(s=>e.jsxs(l.button,{onClick:()=>ue(s.id),disabled:s.isFlipped||s.isMatched||D||o!=="playing",className:"relative w-full h-full",style:{perspective:"1000px"},whileTap:o==="playing"?{scale:.95}:void 0,children:[e.jsxs(l.div,{className:"absolute inset-0 preserve-3d",initial:!1,animate:{rotateY:s.isFlipped||s.isMatched?180:0,opacity:s.isMatched?.3:1,scale:s.isMatched?.9:1},transition:{duration:.3,ease:"easeInOut"},style:{transformStyle:"preserve-3d"},children:[e.jsx("div",{className:"absolute inset-0",style:{backfaceVisibility:"hidden"},children:e.jsx(ie,{})}),e.jsx("div",{className:"absolute inset-0",style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:e.jsx(le,{symbolIndex:s.symbolIndex})})]}),e.jsx(P,{children:Q.find(a=>a.id===s.id)&&e.jsx(re,{color:Q.find(a=>a.id===s.id).color})})]},s.id))})]}),p&&!_&&e.jsx("div",{className:"text-xs text-muted-foreground",children:"Practice Round - Get familiar with the mechanics!"})]})};export{Se as GalacticMatchGame,Se as default};
